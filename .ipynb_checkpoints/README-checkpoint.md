# Comment Sentiment Classification

## Задача проекта

Цель проекта: классификация тональности комментариев на три категории — neutral, positive, negative.

## План исследования

1. Сбор данных через VK API + Python-парсер.
2. Ручная разметка комментариев.
3. Загрузка библиотек и файлов
4. Предобработка и исследовательский анализ данных (очистка, лемматизация, POS-фильтрация).
5. Обучение моделей
    - Использование Pipeline и GridSearchCV
    - Борьба с дисбалансом классов (SMOTE, веса классов).
    - Векторизация TF-IDF, обучение моделей.
6. Проверка модели на адекватность (DummyClassifier)
7. Финальное предсказание на тестовой выборке
8. Анализ Precision-Recall Curve
9. Проверка важности признаков (Feature Importances)
10. Сохранение модели в формате pickle и проверка модели на новых данных
12. Настройка FastAPI
13. Интеграция VK API с моделью (автоматическая загрузка и классификация комментариев)

## Решение

Были обучены 5 моделей на тренировочной выборке:

- Logistic Regression
- ComplementNB
- LinearSVC
- RidgeClassifier
- CatBoostClassifier

Лучшей моделью по результатам обучения оказалась LinearSVC.

Результаты на тестовой выборке:

- F1-macro: 0.58, Accuracy: 0.69
- Класс neutral определяется лучше всего (F1 ≈ 0.79)
- Positive (F1 ≈ 0.53) и Negative (F1 ≈ 0.42) часто путаются с нейтральными

Анализ признаков подтвердил характерные слова для классов.

Основная проблема — дисбаланс классов и схожесть формулировок. Модель подходит как базовое решение, но для повышения качества требуются дополнительные данные и более сложные модели (например, BERT).

## Используемые библиотеки и инструменты

Pandas, NumPy, Matplotlib, Seaborn, tqdm, nltk, spacy, TfidfVectorizer, FunctionTransformer, Imblearn, SMOTE, Sklearn, CatBoost, Pickle, FastAPI, VK API